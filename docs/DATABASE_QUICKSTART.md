# ç–¾ç—…æ•°æ®åº“é›†æˆ - å¿«é€Ÿå¼€å§‹

## ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦æ•°æ®åº“ï¼Ÿ

ä½ çš„é¡¹ç›®æœ‰ä¸¤ä¸ªå…³é”®ç‰¹ç‚¹ï¼š

1. **ç–¾ç—…ç§ç±»ä¼šä¸æ–­å¢åŠ ** âš ï¸
   - æ–°ç–¾ç—…çˆ†å‘ï¼ˆå¦‚COVIDå˜ç§ï¼‰
   - å„å›½å‘ç°æœ¬åœ°åç§°
   - ç–¾ç—…ä¿¡æ¯æ›´æ–°ï¼ˆICDç¼–ç ã€æè¿°ï¼‰

2. **å…¨çƒå¤šå›½å®¶éƒ¨ç½²** ğŸŒ
   - éœ€è¦å…±äº«æ ‡å‡†ç–¾ç—…åº“
   - å¤šå®ä¾‹éœ€è¦æ•°æ®ä¸€è‡´æ€§
   - åˆ†å¸ƒå¼çˆ¬è™«ååŒå·¥ä½œ

**CSVæ–¹æ¡ˆçš„å±€é™**ï¼š
- âŒ æ·»åŠ æ–°ç–¾ç—…éœ€è¦ä¿®æ”¹ä»£ç ã€æäº¤ã€é‡å¯
- âŒ å¤šå®ä¾‹éœ€è¦åŒæ­¥é…ç½®æ–‡ä»¶
- âŒ æ— æ³•åŠ¨æ€å­¦ä¹ å’Œé€‚åº”

**æ•°æ®åº“æ–¹æ¡ˆçš„ä¼˜åŠ¿**ï¼š
- âœ… é€šè¿‡API/CLIå¿«é€Ÿæ·»åŠ æ–°ç–¾ç—…ï¼Œæ— éœ€é‡å¯
- âœ… å¤šå®ä¾‹è‡ªåŠ¨å…±äº«æœ€æ–°æ•°æ®
- âœ… çˆ¬è™«å‘ç°æœªçŸ¥ç–¾ç—…ï¼Œè‡ªåŠ¨è®°å½•å­¦ä¹ 
- âœ… å®Œæ•´å®¡è®¡æ—¥å¿—
- âœ… æ”¯æŒè¯­ä¹‰æœç´¢å’ŒAIå¢å¼º

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ5åˆ†é’Ÿï¼‰

### æ­¥éª¤1: è¿è¡Œè¿ç§»è„šæœ¬

```bash
# å°†CSVæ•°æ®å¯¼å…¥PostgreSQL
python scripts/migrate_diseases_to_db.py
```

**æ‰§è¡Œå†…å®¹**ï¼š
- åˆ›å»º4å¼ è¡¨ï¼ˆstandard_diseases, disease_mappings, learning_suggestions, audit_logï¼‰
- å¯¼å…¥127ç§æ ‡å‡†ç–¾ç—…
- å¯¼å…¥ä¸­å›½æ˜ å°„ï¼ˆ58ä¸»åç§° + 48åˆ«å = 106æ¡ï¼‰
- éªŒè¯æ•°æ®å®Œæ•´æ€§

**é¢„æœŸè¾“å‡º**ï¼š
```
ğŸš€ GlobalID V2 - ç–¾ç—…æ•°æ®è¿ç§»
============================================================

ğŸ“ åˆ›å»ºæ•°æ®åº“è¡¨...
âœ… æ•°æ®åº“è¡¨åˆ›å»ºå®Œæˆ

ğŸ“‘ åˆ›å»ºç´¢å¼•...
âœ… ç´¢å¼•åˆ›å»ºå®Œæˆ

ğŸ“¥ å¯¼å…¥æ ‡å‡†ç–¾ç—…åº“: configs/standard_diseases.csv
   è¯»å– 127 æ¡è®°å½•
âœ… æ ‡å‡†ç–¾ç—…åº“å¯¼å…¥å®Œæˆ: æˆåŠŸ 127, è·³è¿‡ 0, æ€»è®¡ 127

ğŸ“¥ å¯¼å…¥ CN æ˜ å°„: configs/cn/disease_mapping.csv
   è¯»å– 58 æ¡ä¸»æ˜ å°„
âœ… CN æ˜ å°„å¯¼å…¥å®Œæˆ: å…± 106 æ¡

ğŸ” éªŒè¯è¿ç§»ç»“æœ...
============================================================
ğŸ“Š è¿ç§»ç»“æœç»Ÿè®¡:
   æ ‡å‡†ç–¾ç—…åº“: 127 ç§
   å›½å®¶æ˜ å°„:
     - CN: 106 æ¡
============================================================

ğŸ§ª æµ‹è¯•å…³é”®ç–¾ç—…æ˜ å°„:
   âœ… æ–°å† è‚ºç‚ â†’ D004 (COVID-19)
   âœ… è‚ºç»“æ ¸ â†’ D025 (Tuberculosis)
   âœ… è‰¾æ»‹ç—… â†’ D005 (HIV/AIDS)

âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼

============================================================
ğŸ‰ è¿ç§»å®Œæˆï¼
============================================================
```

### æ­¥éª¤2: è¿è¡Œæµ‹è¯•

```bash
# æµ‹è¯•æ•°æ®åº“ç‰ˆæ˜ å°„å™¨
python tests/test_disease_mapper_db.py
```

**æµ‹è¯•å†…å®¹**ï¼š
- åŸºæœ¬æ˜ å°„åŠŸèƒ½
- åˆ«åæ˜ å°„
- DataFrameæ‰¹é‡å¤„ç†
- ç»Ÿè®¡ä¿¡æ¯
- æœªçŸ¥ç–¾ç—…å­¦ä¹ 
- åŠ¨æ€æ·»åŠ ç–¾ç—…

**é¢„æœŸé€šè¿‡ç‡**: 100%

### æ­¥éª¤3: ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·

```bash
# æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
python scripts/disease_cli.py stats

# æœç´¢ç–¾ç—…
python scripts/disease_cli.py search "æ–°å† "

# æŸ¥çœ‹å¾…å®¡æ ¸å»ºè®®
python scripts/disease_cli.py suggestions
```

## ğŸ“˜ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: æ–°ç–¾ç—…çˆ†å‘

```bash
# 2026å¹´å‘ç°çŒ´ç—˜æ–°å˜ç§ï¼Œå¿«é€Ÿæ·»åŠ 
python scripts/disease_cli.py add-disease D142 \
  "Mpox Variant 2026" "çŒ´ç—˜2026å˜ç§" Viral \
  --icd-11 "1E71.1" \
  --description "2026å¹´æ–°å‘çŒ´ç—˜å˜ç§"

# æ·»åŠ ä¸­å›½æœ¬åœ°åç§°
python scripts/disease_cli.py add-mapping D142 "çŒ´ç—˜æ–°å˜ç§"

# âœ… ç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯æœåŠ¡
```

### åœºæ™¯2: çˆ¬è™«å‘ç°æœªçŸ¥ç–¾ç—…

```python
# çˆ¬è™«è‡ªåŠ¨è¿è¡Œæ—¶ä¼šè®°å½•æœªçŸ¥ç–¾ç—…
# æŸ¥çœ‹å»ºè®®
python scripts/disease_cli.py suggestions

# è¾“å‡º:
# ğŸ“‹ å¾…å®¡æ ¸ç–¾ç—…å»ºè®® (CN):
# 
# 1. [123] æœªçŸ¥ç–¾ç—…X
#    å‡ºç°æ¬¡æ•°: 15
#    AIå»ºè®®: Disease X (ç½®ä¿¡åº¦: 0.85)

# æ‰¹å‡†å»ºè®®ï¼ˆè‡ªåŠ¨åˆ›å»ºæ˜ å°„ï¼‰
python scripts/disease_cli.py approve 123 D143
```

### åœºæ™¯3: æ‰¹é‡å¯¼å…¥æ–°æ•°æ®

```python
# scripts/import_who_diseases.py
import pandas as pd
from src.data.normalizers.disease_mapper_db import DiseaseMapperDB

async def import_who_data():
    """ä»WHOå¯¼å…¥æ–°ç–¾ç—…"""
    mapper = DiseaseMapperDB('cn') df = pd.read_csv('who_diseases_2026.csv')
    
    for _, row in df.iterrows():
        await mapper.add_disease(
            disease_id=row['disease_id'],
            standard_name_en=row['name_en'],
            standard_name_zh=row['name_zh'],
            category=row['category'],
            icd_11=row['icd_11'],
            source='WHO_2026'
        )
    
    print(f"âœ… å¯¼å…¥ {len(df)} ç§ç–¾ç—…")
```

### åœºæ™¯4: APIé›†æˆ

```python
# é€šè¿‡APIæ·»åŠ ç–¾ç—…ï¼ˆæ”¯æŒWebç®¡ç†ç•Œé¢ï¼‰
import requests

response = requests.post('http://localhost:8000/api/diseases/add', json={
    "disease_id": "D142",
    "standard_name_en": "New Disease",
    "standard_name_zh": "æ–°ç–¾ç—…",
    "category": "Viral"
})

print(response.json())
# {"success": true, "disease_id": "D142", "message": "ç–¾ç—…æ·»åŠ æˆåŠŸ"}
```

## ğŸ”„ æ—¥å¸¸ç»´æŠ¤

### æ¯å‘¨å®¡æ ¸

```bash
# æŸ¥çœ‹å¾…å®¡æ ¸å»ºè®®
python scripts/disease_cli.py suggestions

# æ‰¹å‡†é«˜ç½®ä¿¡åº¦å»ºè®®
python scripts/disease_cli.py approve <id> <disease_id>
```

### æ¯æœˆå¤‡ä»½

```bash
# ä»æ•°æ®åº“å¯¼å‡ºåˆ°CSVï¼ˆç”¨äºç‰ˆæœ¬æ§åˆ¶ï¼‰
python scripts/export_diseases_to_csv.py

# æäº¤åˆ°Git
git add configs/
git commit -m "Update disease data - $(date +%Y-%m-%d)"
git push
```

### ç›‘æ§æ•°æ®è´¨é‡

```bash
# ç»Ÿè®¡ä¿¡æ¯
python scripts/disease_cli.py stats

# æŸ¥çœ‹ä½¿ç”¨çƒ­åº¦
# TODO: å®ç°çƒ­åº¦åˆ†æå·¥å…·
```

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„

### 1. standard_diseases (æ ‡å‡†ç–¾ç—…åº“)
- 127ç§å…¨çƒæ ‡å‡†ç–¾ç—…
- ICD-10/11ç¼–ç 
- æ”¯æŒè¯­ä¹‰æœç´¢

### 2. disease_mappings (å›½å®¶æ˜ å°„)
- å¤šå›½å®¶æœ¬åœ°åç§°æ˜ å°„
- æ”¯æŒä¸»åç§°å’Œåˆ«å
- è®°å½•ä½¿ç”¨é¢‘ç‡

### 3. disease_learning_suggestions (å­¦ä¹ å»ºè®®)
- çˆ¬è™«å‘ç°çš„æœªçŸ¥ç–¾ç—…
- AIåˆ†æå’Œå»ºè®®
- ç­‰å¾…äººå·¥å®¡æ ¸

### 4. disease_audit_log (å®¡è®¡æ—¥å¿—)
- æ‰€æœ‰å˜æ›´è®°å½•
- æ“ä½œè€…è¿½è¸ª
- åˆè§„æ”¯æŒ

## ğŸ†š CSV vs æ•°æ®åº“å¯¹æ¯”

| åœºæ™¯ | CSVæ–¹æ¡ˆ | æ•°æ®åº“æ–¹æ¡ˆ |
|------|---------|------------|
| æ·»åŠ æ–°ç–¾ç—… | ä¿®æ”¹æ–‡ä»¶ â†’ æäº¤ä»£ç  â†’ é‡å¯æœåŠ¡ | CLIå‘½ä»¤ â†’ ç«‹å³ç”Ÿæ•ˆ |
| å¤šå®ä¾‹éƒ¨ç½² | éœ€è¦åŒæ­¥é…ç½®æ–‡ä»¶ | è‡ªåŠ¨å…±äº«æ•°æ® |
| æœªçŸ¥ç–¾ç—… | æ‰‹åŠ¨å‘ç°å’Œå¤„ç† | è‡ªåŠ¨è®°å½•ã€AIå»ºè®® |
| æ•°æ®å®¡è®¡ | ä¾èµ–Gitå†å² | å®Œæ•´å®¡è®¡æ—¥å¿— |
| æŸ¥è¯¢æ€§èƒ½ | å¿«ï¼ˆå†…å­˜ï¼‰ | å¿«ï¼ˆç´¢å¼•+ç¼“å­˜ï¼‰ |
| å®æ–½æˆæœ¬ | ä½ | ä¸­ |

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“è¿æ¥**: ç¡®ä¿DATABASE_URLæ­£ç¡®é…ç½®
2. **æƒé™ç®¡ç†**: ç”Ÿäº§ç¯å¢ƒéœ€è¦æ§åˆ¶æ·»åŠ /ä¿®æ”¹æƒé™
3. **ç¼“å­˜ç­–ç•¥**: æ•°æ®åº“ç‰ˆæœ¬å†…ç½®å†…å­˜ç¼“å­˜ï¼Œæ€§èƒ½æ¥è¿‘CSV
4. **å¤‡ä»½ç­–ç•¥**: å®šæœŸå¯¼å‡ºåˆ°CSVï¼ŒåŒé‡ä¿éšœ
5. **å®¡æ ¸æµç¨‹**: æœªçŸ¥ç–¾ç—…å»ºè®®å¿…é¡»äººå·¥å®¡æ ¸åæ‰èƒ½ä½¿ç”¨

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å®Œæ•´è®¾è®¡æ–‡æ¡£](DISEASE_MANAGEMENT_STRATEGY.md) - è¯¦ç»†æ¶æ„å’Œå®ç°
- [æ•°æ®åº“æ–¹æ¡ˆå¯¹æ¯”](DATABASE_INTEGRATION.md) - CSV vs æ•°æ®åº“æ·±åº¦åˆ†æ
- [æ•°æ®é‡‡é›†æ–‡æ¡£](DISEASE_DATA_COLLECTION.md) - ä»æƒå¨æ•°æ®æºé‡‡é›†

## ğŸ¤ ä¸‹ä¸€æ­¥

1. âœ… è¿è¡Œè¿ç§»è„šæœ¬
2. âœ… è¿è¡Œæµ‹è¯•éªŒè¯
3. âœ… å°è¯•å‘½ä»¤è¡Œå·¥å…·
4. ğŸ”„ æ›´æ–°åº”ç”¨ä»£ç ä½¿ç”¨DiseaseMapperDB
5. ğŸ”„ é…ç½®å®šæœŸå¤‡ä»½ä»»åŠ¡
6. ğŸ”„ å®ç°Webç®¡ç†ç•Œé¢ï¼ˆå¯é€‰ï¼‰

---

**å‡†å¤‡å¥½äº†å—ï¼Ÿ** è¿è¡Œ `python scripts/migrate_diseases_to_db.py` å¼€å§‹å§ï¼ ğŸš€
